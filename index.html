<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    
    <style>
body {
  font-family: sans-serif;
}

#gantt {
    width: 100%;
    height: 400px;
    border: 1px solid #ccc;
    position: relative;
}

.gantt-item {
    position: absolute;
    height: 20px;
    border-radius: 4px;
    color: white;
    padding-left: 4px;
    font-size: 12px;
    display: flex;
    align-items: center;
}
</style>
    
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
  </head>
  <body>
    
    <div id="gantt"></div>
    
    <script>

// --------------------------------------------------------
// RECEIVE DATA FROM GRIST
// --------------------------------------------------------

grist.ready();

grist.onRecords(records => {
    if (!records) return;
    renderGantt(records);
});

// --------------------------------------------------------
// RENDERING
// --------------------------------------------------------

function renderGantt(rows) {

    const container = document.getElementById("gantt");
    container.innerHTML = "";

    if (!rows.length) return;

    // Extract years
    const minYear = Math.min(...rows.map(r => r.hasStartYear));
    const maxYear = Math.max(...rows.map(r => r.hasEndYear));
    const total = maxYear - minYear;

    rows.forEach((item, index) => {
        const left = ((item.hasStartYear - minYear) / total) * 100;
        const width = ((item.hasEndYear - item.hasStartYear) / total) * 100;

        const bar = document.createElement("div");
        bar.className = "gantt-item";
        bar.style.top = (index * 30) + "px";
        bar.style.left = left + "%";
        bar.style.width = width + "%";
        bar.style.background = item.hasColor || "#666";
        bar.textContent = item.label || item.id;

        container.appendChild(bar);
    });
}

</script>
  </body>
</html>
